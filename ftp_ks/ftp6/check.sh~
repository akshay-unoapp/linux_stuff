# Answers Check Script for ftp6
echo "Give Candidate IP : "
read ip
rm -rf /tmp/exam &> /dev/null
mkdir /tmp/exam &> /dev/null
touch /tmp/exam/flogs &> /dev/null
scp 192.168.1.$ip:/etc/vsftpd/user_list /tmp/exam/user_list_$ip &>> /tmp/exam/flogs
diff /tmp/exam/user_list_$ip answers/user_list &>> /tmp/exam/flogs
a=$?
scp 192.168.1.$ip:/etc/vsftpd/ftpusers /tmp/exam/ftpusers_$ip &>> /tmp/exam/flogs
diff /tmp/exam/ftpusers_$ip answers/ftpusers &>> /tmp/exam/flogs
b=$?
scp 192.168.1.$ip:/etc/vsftpd/vsftpd.conf /tmp/exam/vsftpd.conf_$ip &>> /tmp/exam/flogs
diff /tmp/exam/vsftpd.conf_$ip answers/vsftpd.conf &>> /tmp/exam/flogs
c=$?
if [ $a -eq 0 ] && [ $b -eq 0 ] && [ $c -eq 0 ]; then
	echo "Perfect."
	exit
fi
grep "anonymous" /tmp/exam/user_list_$ip &>> /tmp/exam/flogs
a1=$? # 0 for pass
grep "anonymous" /tmp/exam/ftpusers_$ip &>> /tmp/exam/flogs
a3=$? # 1 for pass
grep "userlist_deny=NO" /tmp/exam/vsftpd.conf_$ip &>> /tmp/exam/flogs
a4=$? # 0 for pass
grep "userlist_enable=YES" /tmp/exam/vsftpd.conf_$ip &>> /tmp/exam/flogs
a5=$? # 0 for pass
grep "write_enable=NO" /tmp/exam/vsftpd.conf_$ip &>> /tmp/exam/flogs
a6=$? # 0 for pass
grep "#write_enable=YES" /tmp/exam/vsftpd.conf_$ip &>> /tmp/exam/flogs
a7=$? # 0 for pass
if [ $a1 -eq 0 ] && [ $a3 -eq 1 ] && [ $a4 -eq 0 ] && [ $a5 -eq 0 ] && [ $c -eq 0 ] && [ $a6 -eq 0 ] || [ $a7 -eq 0 ]; then
	echo "Pass."
else 
	echo "Fail."
fi
